name: Publish

on:
  push:
    branches:
      - main
      - release
  workflow_dispatch:

concurrency: release

jobs:
  # ci:
  # name: Continuous Integration
  # uses: makerxstudio/shared-config/.github/workflows/node-ci.yml@main
  # with:
  #   node-version: 20.x
  #   run-commit-lint: true
  #   pre-test-script: |
  #     pipx install algokit
  #     algokit localnet start
  #     npx --yes wait-on tcp:4001 -t 30000
  #   audit-script: |
  #     npm run audit
  # NOTE: This job runs tests and checks and has been commented out.

  # build:
  # name: Build
  # uses: makerxstudio/shared-config/.github/workflows/node-build-zip.yml@main
  # needs:
  #   - ci
  # with:
  #   node-version: 20.x
  #   build-path: dist
  #   artifact-name: package
  # NOTE: This job generates and archives the built source code and artifacts, which is no longer explicitly run.

  # release:
  # ... (Entire release job commented out in the previous revision)

  generate-publish-docs:
    name: Publish docs
    # WARNING: Since 'build' is commented out, the 'needs' dependency must be removed or changed.
    # We will remove it, assuming the documentation files are available without an explicit 'build' job here,
    # or that the nested workflow handles checkout/setup/build itself.
    # needs: build
    if: github.ref_name == 'release'
    uses: ./.github/workflows/gh-pages.yml
    secrets:
      BOT_ID: ${{ secrets.BOT_ID }}
      BOT_SK: ${{ secrets.BOT_SK }}
    # NOTE: This is the CORE job responsible for documentation publication to GitHub Pages.
